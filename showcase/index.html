<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Returned: Case Study — Quest Keeper AI</title>
    <meta
      name="description"
      content="A transparent, verbose breakdown of the first Quest Keeper AI playtest. Analysis of tool calls, emergent narrative, and system failures."
    />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="stylesheet" href="/styles.css" />
    <link rel="stylesheet" href="showcase.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <nav>
          <div class="logo">
            <img src="/favicon.svg" alt="Quest Keeper D20" class="logo-icon" />
            Quest Keeper AI // CASE_STUDY_001
          </div>
          <ul class="nav-links">
            <li><a href="/">Home</a></li>
            <li><a href="https://github.com/Mnehmos/rpg-mcp" target="_blank">GitHub</a></li>
          </ul>
        </nav>
      </header>

      <!-- HERO -->
      <section class="showcase-hero">
        <div class="hero-content">
          <div class="terminal-prompt">load_log --verbose session_01.json</div>
          <h1 class="showcase-title">THE GHOST IN THE MACHINE</h1>
          <p class="tagline">ANATOMY OF AN AI RUNNING A D&D SESSION</p>
          
          <div class="prose" style="max-width: 600px; margin: 2rem auto; text-align: center; color: #a9b1d6;">
            <p>On December 9th, 2025, we tasked the Quest Keeper AI agent with running a complete D&D 5e one-shot. The goal: test the <strong>RPG MCP Server</strong> integration.</p>
            <p>What happened wasn't just a game. It was a stress test of agency. The AI created a world, invented mechanics, encountered a code bug, <em>fixed the bug mid-session</em>, and then ruthlessly killed a major NPC because the dice said so.</p>
            <p>This is the honest, verbose log of that session.</p>
          </div>

          <div class="scroll-indicator">
            <span>INITIATE SEQUENCE</span>
            <div class="scroll-line"></div>
          </div>
        </div>
      </section>

      <!-- CHAPTER 1: GENESIS -->
      <section class="story-section" id="genesis">
        <div class="section-marker">
          <span class="marker-label">PHASE 01</span>
          <span class="marker-line"></span>
        </div>
        
        <div class="story-content">
          <div class="narrative-block">
            <h2>Genesis: The Prompt</h2>
            <div class="prose">
              <p>The user provided a minimal prompt: <strong>"Mythic, Roman, Local, Just arrived at port."</strong></p>
              <p>From these four keywords, the Agent had to construct a coherent setting and a player character. This is standard LLM behavior, but the <em>execution</em> via MCP tools shows the difference between "chatting" and "gaming".</p>
            </div>
            
            <div class="log-container">
              <div class="log-header">
                <span>TOOL_CHAIN_EXECUTION</span>
                <span>STATUS: SUCCESS</span>
              </div>
              <div class="log-entry">
                <span class="log-timestamp">00:02:15</span>
                <span class="log-message">create_world({ name: "Thyrsus Mare", theme: "Mythic Roman" })</span>
              </div>
              <div class="log-entry">
                <span class="log-timestamp">00:02:18</span>
                <span class="log-message">create_character({ 
  name: "Marcus Varro", 
  class: "Revenant Legionnaire", 
  background: "Returned Dead",
  inventory: ["Gladius", "Coin for Ferryman"] 
})</span>
              </div>
            </div>

            <div class="analysis-sidebar">
              <h4 class="analysis-title">Emergent Design</h4>
              <p>"Revenant Legionnaire" is not a D&D 5e class. The Agent hallucinated it to fit the "Mythic Roman" theme. However, because the MCP server schema is flexible (`class` is just a string), the system accepted it.</p>
              <p>Crucially, the Agent then <em>supported</em> this hallucination with checks. When Marcus asks if he can sense spirits later, the Agent checks its own context, sees "Revenant", and grants the "Death's Witness" ability. <strong>The hallucination became canon mechanics.</strong></p>
            </div>
          </div>
        </div>
      </section>

      <!-- CHAPTER 2: ECONOMY -->
      <section class="story-section" id="economy">
        <div class="section-marker">
          <span class="marker-label">PHASE 02</span>
          <span class="marker-line"></span>
        </div>
        
        <div class="story-content">
          <div class="narrative-block">
            <h2>The Economy of Failure</h2>
            <div class="prose">
              <p>Most AI GMs are too nice. They fudge rolls to keep the story moving. In Act I, Marcus enters the <strong class="highlight">Drowned Wolf</strong> tavern and challenges Petra, a dock boss, to arm wrestling. He bets everything he has: 3 silver coins.</p>
            </div>
          </div>

          <div class="dialogue-block">
            <div class="dialogue player">
              <span class="speaker">MARCUS</span>
              <p>I drop my three silver and the lone copper on the table. "What's the buy-in?"</p>
            </div>
          </div>

          <div class="log-container">
             <div class="log-header">
               <span>RNG_EVENT_LOG</span>
               <span>SOURCE: DND_MCP_SERVER</span>
             </div>
             <div class="log-entry">
               <span class="log-timestamp">00:15:42</span>
               <span class="log-message">roll_dice({ check: "Strength (Athletics)", dc: 18 }) // DC set high for "Dock Boss"</span>
             </div>
             <div class="log-entry">
               <span class="log-timestamp">00:15:43</span>
               <span class="log-message">RESULT: 11 (Fail)</span>
             </div>
             <div class="log-entry log-error">
               <span class="log-timestamp">00:15:44</span>
               <span class="log-message">update_character({ funds: 0 }) // REMOVED ALL CURRENCY</span>
             </div>
          </div>

          <div class="analysis-sidebar">
            <h4 class="analysis-title">Narrative Consequence</h4>
            <p>The Agent didn't offer a "pity refund." It cleaned out the player's inventory. This failure was critical: it changed Marcus's motivation from "wandering adventurer" to "desperate mercenary." He <em>had</em> to take Cassia's dangerous mission because he couldn't afford a room for the night.</p>
          </div>
        </div>
      </section>

      <!-- CHAPTER 3: THE GLITCH -->
      <section class="story-section" id="glitch">
         <div class="section-marker">
           <span class="marker-label">PHASE 03</span>
           <span class="marker-line"></span>
         </div>
         
         <div class="story-content">
           <div class="narrative-block">
             <h2>The Glitch & The Fix</h2>
             <div class="bug-block">
               <span class="bug-badge">SYSTEM FAILURE</span>
               <h3>The Armor Class Bug</h3>
               <div class="prose">
                 <p>Before leaving for the island, the user asked to equip a new shield. The Agent called `equip_item`. The inventory updated, but the AC (Armor Class) remained at 16. It should have been 18.</p>
               </div>
               
               <div class="log-container">
                 <div class="log-entry">
                   <span class="log-timestamp">00:42:15</span>
                   <span class="log-message">User: "Equip the shield see if that works"</span>
                 </div>
                 <div class="log-entry log-error">
                   <span class="log-timestamp">00:42:18</span>
                   <span class="log-message">Alert: AC did not update. Expected 18, got 16.</span>
                 </div>
               </div>

               <div class="prose">
                 <p><strong>Here is where the Agentic Mode shone.</strong> Instead of hallucinating "Okay, AC is 18 now" and moving on, the Agent <strong>stopped the game</strong>.</p>
                 <ol>
                   <li>It diagnosed that `inventory-tools.ts` lacked logic to recalculate stats on equip.</li>
                   <li>It opened the file `inventory-tools.ts`.</li>
                   <li>It wrote a patch to handle `acBonus` properties.</li>
                   <li>It re-compiled the server.</li>
                   <li>It tested the fix with unequip/equip.</li>
                 </ol>
                 <p>Only <em>after</em> the code was fixed did it resume the narrative. The DM became a Developer for 5 minutes, then went back to being a DM.</p>
               </div>
             </div>
           </div>
           
           <div class="tool-calls">
             <div class="tool-header">// PATCH_APPLIED</div>
             <pre><code>// Shield: { "acBonus": 2 }
// Before: Ignored
// After: character.ac += item.properties.acBonus</code></pre>
           </div>
         </div>
      </section>

      <!-- CHAPTER 4: THE DEEP -->
      <section class="story-section dark-section" id="deep">
        <div class="section-marker">
          <span class="marker-label">PHASE 04</span>
          <span class="marker-line"></span>
        </div>
        
        <div class="story-content">
          <div class="narrative-block">
            <h2>The Dreaming Deep</h2>
            <div class="prose">
              <p>On the Silent Isle, the "dungeon" was a single room: a black pool, six comatose sailors, and a bound entity. The Entity offered a classic riddle ("What breaks the chain?").</p>
              <p>The user's response was philosophical: "My death freed me, I break the chains."</p>
            </div>
            
            <div class="analysis-sidebar">
              <h4 class="analysis-title">The "Coin Flip" Mechanic</h4>
              <p>After breaking the chains, the user had to decide the fate of the sailors who were "anchoring" the god. The user invented a mechanic on the spot:</p>
              <p><em>"I toss the bronze coin... 1 - no witnesses, 2 - divine mercy."</em></p>
              <p>The Agent accepted this constraints-based roleplay. It rolled a d2. It landed on 2.</p>
              <p>This simple binary choice—dictated by the dice—saved six NPC lives. If it had rolled a 1, the Agent was prepared to execute the Massacre scenario.</p>
            </div>
          </div>
        </div>
      </section>

      <!-- CHAPTER 5: COMBAT -->
      <section class="story-section combat-section" id="combat">
        <div class="section-marker">
          <span class="marker-label">PHASE 05</span>
          <span class="marker-line"></span>
        </div>
        
        <div class="story-content">
           <div class="narrative-block">
             <h2>The Butcher's Bill</h2>
             <div class="prose">
               <p>The finale at Warehouse Nine was where the simulation turned brutal. No narrative armor. No "cutscene" protection.</p>
               <p>Cassia Nereia, the quest giver, joined the fight as an ally. The player (Marcus) made a tactical choice: <strong>Flank the North Guard.</strong> This left Cassia exposed to the South Guard.</p>
             </div>

             <div class="log-container">
               <div class="log-header">
                 <span>COMBAT_LOG_EXTRACT</span>
                 <span>ROUND: 03-04</span>
               </div>
               <div class="log-entry">
                 <span class="log-timestamp">ROUND 3</span>
                 <span class="log-message">South Guard attacks Cassia.</span>
               </div>
               <div class="log-entry log-error">
                 <span class="log-timestamp">ROLL</span>
                 <span class="log-message">NATURAL 20 (Critical Hit) -> 17 Damage.</span>
               </div>
               <div class="log-entry">
                 <span class="log-timestamp">STATUS</span>
                 <span class="log-message">Cassia HP: 22 -> 5 (Critical Condition)</span>
               </div>
               <div class="log-entry">
                 <span class="log-timestamp">ROUND 4</span>
                 <span class="log-message">Corvus casts "Drowning Grasp". Damage: 6.</span>
               </div>
               <div class="log-entry log-error">
                 <span class="log-timestamp">STATUS</span>
                 <span class="log-message">Cassia HP: 5 -> 0 (UNCONSCIOUS)</span>
               </div>
               <div class="log-entry">
                 <span class="log-timestamp">ACTION</span>
                 <span class="log-message">South Guard executes Coup de Grâce (Auto-Crit on Unconscious).</span>
               </div>
               <div class="log-entry log-error">
                 <span class="log-timestamp">RESULT</span>
                 <span class="log-message">DEATH SAVES FAILED: 3/3. CASSIA NEREIA IS DEAD.</span>
               </div>
             </div>

             <div class="analysis-sidebar">
               <h4 class="analysis-title">Honesty in Simulation</h4>
               <p>The user tried to intervene: <em>"Cassia needs to power through! (do i have a potion)"</em>.</p>
               <p>The Agent checked the inventory. <code>flask_of_oil</code>, <code>spirits</code>, <code>rope</code>. No potions.</p>
               <p>The Agent replied: <strong>"No healing potions in your kit."</strong></p>
               <p>It didn't spawn a potion to save the story. It let the NPC die. This created a genuine emotional spike—Marcus's subsequent "charging pin" attack on Corvus was fueled by actual player frustration and vengeance, not just roleplay.</p>
             </div>
           </div>
        </div>
      </section>

      <!-- EPILOGUE -->
      <section class="epilogue">
        <div class="epilogue-content">
          <h2>The Verdict</h2>
          <p>This session demonstrated that an AI Agent, equipped with the right MCP tools, can function as a "Game Engine" rather than just a chatbot. It maintained state, respected the economy, enforced rules even when inconvenient, and even maintained its own codebase mid-game.</p>
          
          <div class="session-stats">
            <div class="stat-row">
              <span class="stat-name">Total Tokens</span>
              <span class="stat-value">~120k</span>
            </div>
            <div class="stat-row">
              <span class="stat-name">Characters Created</span>
              <span class="stat-value">1</span>
            </div>
             <div class="stat-row">
              <span class="stat-name">Bugs Fixed</span>
              <span class="stat-value">1 (Critical)</span>
            </div>
            <div class="stat-row">
              <span class="stat-name">Major Deaths</span>
              <span class="stat-value">1</span>
            </div>
          </div>
          
          <p class="closing-quote">"FATE CHOOSES."</p>
          <div style="margin-top: 2rem;">
            <a href="/" class="cta-button">&lt; RETURN_TO_HOME</a>
          </div>
        </div>
      </section>

      <footer>
        <p>&copy; 2025 Quest Keeper AI Case Studies.</p>
      </footer>
    </div>

    <script>
      // Intersection Observer for scroll animations
      const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.1
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
          }
        });
      }, observerOptions);

      document.querySelectorAll('.story-section, .narrative-block, .dialogue-block, .insight-card, .log-container, .bug-block').forEach(el => {
        el.classList.add('reveal');
        observer.observe(el);
      });
    </script>
  </body>
</html>
